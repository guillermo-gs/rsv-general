<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.guillermogonzalezs.rsv.cliente.infrastructure.repository.ClienteMybatis">

    <resultMap id="clienteResultMap" type="com.guillermogonzalezs.rsv.cliente.domain.entities.Cliente" autoMapping="true">
        <result property="fisicoJuridico" column="fisico_juridico"/>
    </resultMap>


    <sql id="baseColumnsInsert">
        nombre, apellidos, dni, fisico_juridico, telefono, direccion, cpostal, poblacion, email, activo
    </sql>

    <sql id="select">
        select
            c.id, c.nombre, c.apellidos, c.dni, c.fisico_juridico as fisicoJuridico, c.telefono, c.direccion, c.cpostal, c.poblacion, c.email, c.activo
        from
            cliente c
    </sql>

    <insert id="create" useGeneratedKeys="true" keyProperty="cli.id" keyColumn="ID">
        INSERT INTO cliente(<include refid="baseColumnsInsert"/>)
        VALUES (
        #{cli.nombre, jdbcType=VARCHAR},
        #{cli.apellidos, jdbcType=DATE},
        #{cli.dni, jdbcType=DATE},
        #{cli.fisicoJuridico, jdbcType=DATE},
        #{cli.telefono, jdbcType=INTEGER},
        #{cli.direccion, jdbcType=INTEGER},
        #{cli.cpostal, jdbcType=INTEGER},
        #{cli.poblacion, jdbcType=INTEGER},
        #{cli.email, jdbcType=INTEGER},
        #{cli.activo,jdbcType=BOOLEAN}
        )
        </insert>

    <update id="update" >
        update cliente set
          nombre=#{ cli.nombre, jdbcType=VARCHAR},
          apellidos=#{ cli.apellidos, jdbcType=VARCHAR},
          dni=#{ cli.dni, jdbcType=VARCHAR},
          fisico_juridico=#{ cli.fisicoJuridico, jdbcType=VARCHAR},
          telefono=#{ cli.telefono, jdbcType=VARCHAR},
          direccion=#{ cli.direccion, jdbcType=VARCHAR},
          cpostal=#{ cli.cpostal, jdbcType=VARCHAR},
          poblacion=#{ cli.poblacion, jdbcType=VARCHAR},
          email=#{ cli.email, jdbcType=VARCHAR},
          activo=#{ cli.activo, jdbcType=BOOLEAN}
        where id = #{ cli.id, jdbcType=INTEGER}
    </update>
    <delete id="delete"></delete>

    <select id="findAll" resultType="com.guillermogonzalezs.rsv.cliente.domain.entities.Cliente">
        <include refid="select"></include>
    </select>
    <select id="findById" resultType="com.guillermogonzalezs.rsv.cliente.domain.entities.Cliente">
        <include refid="select"></include>
        WHERE id = #{id,  jdbcType=INTEGER}
    </select>


    <select id="getId" resultType="java.lang.Integer">
        SELECT servicioprevio_seq.nextval FROM dual
    </select>



</mapper>